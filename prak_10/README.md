# –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–Ω—è—Ç–∏–µ ‚Ññ10 - JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –≤ Go —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º middleware.

## üìã –û–ø–∏—Å–∞–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω HTTP-—Å–µ—Ä–≤–∏—Å —Å:
- JWT-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (HS256)
- RBAC-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π (—Ä–æ–ª–∏ admin/user)
- Refresh-—Ç–æ–∫–µ–Ω–∞–º–∏
- ABAC-–ø—Ä–∞–≤–∏–ª–∞–º–∏ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º
- Middleware –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## üèó –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```azure
pz10-auth/
‚îú‚îÄ‚îÄ cmd/
‚îÇ ‚îî‚îÄ‚îÄ server/
‚îÇ ‚îî‚îÄ‚îÄ main.go
‚îú‚îÄ‚îÄ internal/
‚îÇ ‚îú‚îÄ‚îÄ core/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ user.go
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ service.go
‚îÇ ‚îú‚îÄ‚îÄ http/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ router.go
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ middleware/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ authn.go
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ authz.go
‚îÇ ‚îú‚îÄ‚îÄ platform/
‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ config/
‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ config.go
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ jwt/
‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ jwt.go
‚îÇ ‚îî‚îÄ‚îÄ repo/
‚îÇ ‚îî‚îÄ‚îÄ user_mem.go
‚îî‚îÄ‚îÄ go.mod
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
mkdir prak_10 && cd prak_10
```
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```bash
go mod init example.com/pz10-auth
go get github.com/go-chi/chi/v5
go get github.com/golang-jwt/jwt/v5
go get golang.org/x/crypto/bcrypt
```
## –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# Windows PowerShell
$env:JWT_SECRET="dev-secret"; $env:JWT_TTL="2h"; $env:APP_PORT="8080"; go run ./cmd/server
```
# üì° API Endpoints
## –ü—É–±–ª–∏—á–Ω—ã–µ endpoints
```azure
POST /api/v1/login - –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, –ø–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

POST /api/v1/refresh - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ access-—Ç–æ–∫–µ–Ω–∞
```
## –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ endpoints
```azure
GET /api/v1/me - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–µ–∫—É—â–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ

GET /api/v1/admin/stats - —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è admin)

GET /api/v1/users/{id} - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ (ABAC)
```
# üõ† –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
## –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
```bash
curl -X POST http://localhost:8080/api/v1/login \
  -H "Content-Type: application/json" \
  -d '{"Email":"admin@example.com","Password":"secret123"}'
```
## –î–æ—Å—Ç—É–ø –∫ –∑–∞—â–∏—â–µ–Ω–Ω—ã–º —Ä–µ—Å—É—Ä—Å–∞–º
```bash
# –ó–∞–ø—Ä–æ—Å —Å —Ç–æ–∫–µ–Ω–æ–º
curl -H "Authorization: Bearer <your_token>" http://localhost:8080/api/v1/me

# –ü—Ä–æ–≤–µ—Ä–∫–∞ ABAC
curl -H "Authorization: Bearer <user_token>" http://localhost:8080/api/v1/users/2
```
# ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```azure
JWT_SECRET - —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ JWT (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)

JWT_TTL - –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ —Ç–æ–∫–µ–Ω–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 24h)

APP_PORT - –ø–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 8080)
```
# üîß –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
```
Stateless-–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT

Middleware-—Ü–µ–ø–æ—á–∫–∞ –¥–ª—è AuthN/AuthZ

RBAC –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π –≤ JWT-—Ç–æ–∫–µ–Ω–µ

ABAC –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–º

Refresh-—Ç–æ–∫–µ–Ω—ã —Å blacklist'–æ–º

Bcrypt –¥–ª—è —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
```